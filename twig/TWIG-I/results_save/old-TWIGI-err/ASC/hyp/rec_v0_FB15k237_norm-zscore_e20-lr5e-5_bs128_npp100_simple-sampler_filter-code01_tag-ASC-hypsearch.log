['run_exp.py', '0', 'FB15k237', '20', '5e-5', 'zscore', '128', '64', '100', '0', '1', 'simple', '1']
Creating a new model from scratch
loading NN
done loading NN
loading dataset
FB15k237
X_p: torch.Size([272115, 23])
X_p: torch.Size([20438, 23])
X_p: torch.Size([17526, 23])
done loading dataset
loading filters
done loading filters
loading negative samplers
loading triple features from cache
done loading negative samplers
Running in hyperparameter evaluation mode
TWIG will be evaulaited on the validation set
and will not be tested each epoch on the validation set
running training and eval
TWIG_KGL_v0(
  (linear_struct_1): Linear(in_features=22, out_features=10, bias=True)
  (relu_1): ReLU()
  (dropout_1): Dropout(p=0.01, inplace=False)
  (linear_struct_2): Linear(in_features=10, out_features=10, bias=True)
  (relu_2): ReLU()
  (dropout_2): Dropout(p=0.01, inplace=False)
  (linear_final): Linear(in_features=10, out_features=1, bias=True)
  (sigmoid_final): Sigmoid()
)
REC: Training with epochs = 20
Epoch 1 -- batch 0 / 2126 loss: 0.10631450265645981
batch 500 / 2126 loss: 0.08880248665809631
batch 1000 / 2126 loss: 0.06633063405752182
batch 1500 / 2126 loss: 0.045321013778448105
batch 2000 / 2126 loss: 0.04076649993658066
Epoch 2 -- batch 0 / 2126 loss: 0.03659072890877724
batch 500 / 2126 loss: 0.01013253629207611
batch 1000 / 2126 loss: 0.009130280464887619
batch 1500 / 2126 loss: 0.004820012953132391
batch 2000 / 2126 loss: 0.005993297789245844
Epoch 3 -- batch 0 / 2126 loss: 0.011442136950790882
batch 500 / 2126 loss: 0.0020604871679097414
batch 1000 / 2126 loss: 0.0010733184171840549
batch 1500 / 2126 loss: 0.00184864632319659
batch 2000 / 2126 loss: 0.00183634995482862
Epoch 4 -- batch 0 / 2126 loss: 0.002982295351102948
batch 500 / 2126 loss: 0.0008203571778722107
batch 1000 / 2126 loss: 0.0006238390924409032
batch 1500 / 2126 loss: 0.001081853755749762
batch 2000 / 2126 loss: 0.0011656899005174637
Epoch 5 -- batch 0 / 2126 loss: 0.0012991285184398293
batch 500 / 2126 loss: 0.0003759645624086261
batch 1000 / 2126 loss: 0.0004517975321505219
batch 1500 / 2126 loss: 0.00043308676686137915
batch 2000 / 2126 loss: 0.0005113136139698327
Saving checkpoint at epoch 5; prefix = chkpt-ID_8883751924766851
Epoch 6 -- batch 0 / 2126 loss: 0.0006524516502395272
batch 500 / 2126 loss: 0.00014444754924625158
batch 1000 / 2126 loss: 0.0004998165532015264
batch 1500 / 2126 loss: 0.0002939176047220826
batch 2000 / 2126 loss: 0.00043719771201722324
Epoch 7 -- batch 0 / 2126 loss: 0.0004712758236564696
batch 500 / 2126 loss: 0.00014300314069259912
batch 1000 / 2126 loss: 0.00026668841019272804
batch 1500 / 2126 loss: 0.0003626019461080432
batch 2000 / 2126 loss: 0.0004219012917019427
Epoch 8 -- batch 0 / 2126 loss: 0.0003642116498667747
batch 500 / 2126 loss: 9.005207539303228e-05
batch 1000 / 2126 loss: 0.00011965724115725607
batch 1500 / 2126 loss: 0.0002659931778907776
batch 2000 / 2126 loss: 0.00020561083510983735
Epoch 9 -- batch 0 / 2126 loss: 0.00020991565543226898
batch 500 / 2126 loss: 8.000400703167543e-05
batch 1000 / 2126 loss: 0.0001029111081152223
batch 1500 / 2126 loss: 0.00021417660173028708
batch 2000 / 2126 loss: 0.00020254985429346561
Epoch 10 -- batch 0 / 2126 loss: 0.00010339062282582745
batch 500 / 2126 loss: 5.235148637439124e-05
batch 1000 / 2126 loss: 3.527665467117913e-05
batch 1500 / 2126 loss: 0.00028386712074279785
batch 2000 / 2126 loss: 8.526651072315872e-05
Saving checkpoint at epoch 10; prefix = chkpt-ID_8883751924766851
Epoch 11 -- batch 0 / 2126 loss: 8.754047303227708e-05
batch 500 / 2126 loss: 4.794902997673489e-05
batch 1000 / 2126 loss: 1.4278145499702077e-05
batch 1500 / 2126 loss: 0.0002038418606389314
batch 2000 / 2126 loss: 0.00010245441080769524
Epoch 12 -- batch 0 / 2126 loss: 6.72199676046148e-05
batch 500 / 2126 loss: 8.324928057845682e-05
batch 1000 / 2126 loss: 4.99703164678067e-05
batch 1500 / 2126 loss: 0.00011482198169687763
batch 2000 / 2126 loss: 8.493592031300068e-05
Epoch 13 -- batch 0 / 2126 loss: 2.4132155886036344e-05
batch 500 / 2126 loss: 8.76717094797641e-05
batch 1000 / 2126 loss: 6.531052349600941e-05
batch 1500 / 2126 loss: 0.0001508915302110836
batch 2000 / 2126 loss: 1.0267724064760841e-05
Epoch 14 -- batch 0 / 2126 loss: 5.023611447541043e-05
batch 500 / 2126 loss: 1.3151096027286258e-05
batch 1000 / 2126 loss: 4.0418952266918495e-05
batch 1500 / 2126 loss: 0.00014688630471937358
batch 2000 / 2126 loss: 5.824902837048285e-05
Epoch 15 -- batch 0 / 2126 loss: 1.609305400052108e-05
batch 500 / 2126 loss: 6.523754564113915e-05
batch 1000 / 2126 loss: 9.028703971125651e-06
batch 1500 / 2126 loss: 0.00012453737144824117
batch 2000 / 2126 loss: 5.6729950301814824e-05
Saving checkpoint at epoch 15; prefix = chkpt-ID_8883751924766851
Epoch 16 -- batch 0 / 2126 loss: 2.574215795903001e-05
batch 500 / 2126 loss: 5.006251740269363e-05
batch 1000 / 2126 loss: 5.892765329917893e-06
batch 1500 / 2126 loss: 4.3054151319665834e-05
batch 2000 / 2126 loss: 7.783889304846525e-05
Epoch 17 -- batch 0 / 2126 loss: 2.9625445677083917e-05
batch 500 / 2126 loss: 1.5616864402545616e-05
batch 1000 / 2126 loss: 3.275427297921851e-05
batch 1500 / 2126 loss: 8.015950879780576e-05
batch 2000 / 2126 loss: 4.265743336873129e-05
Epoch 18 -- batch 0 / 2126 loss: 4.428032843861729e-05
batch 500 / 2126 loss: 9.758091437106486e-06
batch 1000 / 2126 loss: 1.5113386325538158e-05
batch 1500 / 2126 loss: 4.236896347720176e-05
batch 2000 / 2126 loss: 4.002259629487526e-06
Epoch 19 -- batch 0 / 2126 loss: 8.583164890296757e-05
batch 500 / 2126 loss: 2.1193262000451796e-05
batch 1000 / 2126 loss: 1.466114008508157e-05
batch 1500 / 2126 loss: 7.109269790817052e-05
batch 2000 / 2126 loss: 1.4116802958596963e-05
Epoch 20 -- batch 0 / 2126 loss: 9.73623991740169e-06
batch 500 / 2126 loss: 1.5012716175988317e-05
batch 1000 / 2126 loss: 7.462129360646941e-06
batch 1500 / 2126 loss: 5.6931105063995346e-05
batch 2000 / 2126 loss: 2.7150821551913396e-05
Saving checkpoint at epoch 20; prefix = chkpt-ID_8883751924766851
Done Training!

==================================
Testing (cite this): dataloader for dataset FB15k237
Testing (cite this): batch 0 / 274
Testing (cite this): batch 1 / 274
Testing (cite this): batch 2 / 274
Testing (cite this): batch 3 / 274
Testing (cite this): batch 4 / 274
Testing (cite this): batch 5 / 274
Testing (cite this): batch 6 / 274
Testing (cite this): batch 7 / 274
Testing (cite this): batch 8 / 274
Testing (cite this): batch 9 / 274
Testing (cite this): batch 10 / 274
Testing (cite this): batch 11 / 274
Testing (cite this): batch 12 / 274
Testing (cite this): batch 13 / 274
Testing (cite this): batch 14 / 274
Testing (cite this): batch 15 / 274
Testing (cite this): batch 16 / 274
Testing (cite this): batch 17 / 274
Testing (cite this): batch 18 / 274
Testing (cite this): batch 19 / 274
Testing (cite this): batch 20 / 274
Testing (cite this): batch 21 / 274
Testing (cite this): batch 22 / 274
Testing (cite this): batch 23 / 274
Testing (cite this): batch 24 / 274
Testing (cite this): batch 25 / 274
Testing (cite this): batch 26 / 274
Testing (cite this): batch 27 / 274
Testing (cite this): batch 28 / 274
Testing (cite this): batch 29 / 274
Testing (cite this): batch 30 / 274
Testing (cite this): batch 31 / 274
Testing (cite this): batch 32 / 274
Testing (cite this): batch 33 / 274
Testing (cite this): batch 34 / 274
Testing (cite this): batch 35 / 274
Testing (cite this): batch 36 / 274
Testing (cite this): batch 37 / 274
Testing (cite this): batch 38 / 274
Testing (cite this): batch 39 / 274
Testing (cite this): batch 40 / 274
Testing (cite this): batch 41 / 274
Testing (cite this): batch 42 / 274
Testing (cite this): batch 43 / 274
Testing (cite this): batch 44 / 274
Testing (cite this): batch 45 / 274
Testing (cite this): batch 46 / 274
Testing (cite this): batch 47 / 274
Testing (cite this): batch 48 / 274
Testing (cite this): batch 49 / 274
Testing (cite this): batch 50 / 274
Testing (cite this): batch 51 / 274
Testing (cite this): batch 52 / 274
Testing (cite this): batch 53 / 274
Testing (cite this): batch 54 / 274
Testing (cite this): batch 55 / 274
Testing (cite this): batch 56 / 274
Testing (cite this): batch 57 / 274
Testing (cite this): batch 58 / 274
Testing (cite this): batch 59 / 274
Testing (cite this): batch 60 / 274
Testing (cite this): batch 61 / 274
Testing (cite this): batch 62 / 274
Testing (cite this): batch 63 / 274
Testing (cite this): batch 64 / 274
Testing (cite this): batch 65 / 274
Testing (cite this): batch 66 / 274
Testing (cite this): batch 67 / 274
Testing (cite this): batch 68 / 274
Testing (cite this): batch 69 / 274
Testing (cite this): batch 70 / 274
Testing (cite this): batch 71 / 274
Testing (cite this): batch 72 / 274
Testing (cite this): batch 73 / 274
Testing (cite this): batch 74 / 274
Testing (cite this): batch 75 / 274
Testing (cite this): batch 76 / 274
Testing (cite this): batch 77 / 274
Testing (cite this): batch 78 / 274
Testing (cite this): batch 79 / 274
Testing (cite this): batch 80 / 274
Testing (cite this): batch 81 / 274
Testing (cite this): batch 82 / 274
Testing (cite this): batch 83 / 274
Testing (cite this): batch 84 / 274
Testing (cite this): batch 85 / 274
Testing (cite this): batch 86 / 274
Testing (cite this): batch 87 / 274
Testing (cite this): batch 88 / 274
Testing (cite this): batch 89 / 274
Testing (cite this): batch 90 / 274
Testing (cite this): batch 91 / 274
Testing (cite this): batch 92 / 274
Testing (cite this): batch 93 / 274
Testing (cite this): batch 94 / 274
Testing (cite this): batch 95 / 274
Testing (cite this): batch 96 / 274
Testing (cite this): batch 97 / 274
Testing (cite this): batch 98 / 274
Testing (cite this): batch 99 / 274
Testing (cite this): batch 100 / 274
Testing (cite this): batch 101 / 274
Testing (cite this): batch 102 / 274
Testing (cite this): batch 103 / 274
Testing (cite this): batch 104 / 274
Testing (cite this): batch 105 / 274
Testing (cite this): batch 106 / 274
Testing (cite this): batch 107 / 274
Testing (cite this): batch 108 / 274
Testing (cite this): batch 109 / 274
Testing (cite this): batch 110 / 274
Testing (cite this): batch 111 / 274
Testing (cite this): batch 112 / 274
Testing (cite this): batch 113 / 274
Testing (cite this): batch 114 / 274
Testing (cite this): batch 115 / 274
Testing (cite this): batch 116 / 274
Testing (cite this): batch 117 / 274
Testing (cite this): batch 118 / 274
Testing (cite this): batch 119 / 274
Testing (cite this): batch 120 / 274
Testing (cite this): batch 121 / 274
Testing (cite this): batch 122 / 274
Testing (cite this): batch 123 / 274
Testing (cite this): batch 124 / 274
Testing (cite this): batch 125 / 274
Testing (cite this): batch 126 / 274
Testing (cite this): batch 127 / 274
Testing (cite this): batch 128 / 274
Testing (cite this): batch 129 / 274
Testing (cite this): batch 130 / 274
Testing (cite this): batch 131 / 274
Testing (cite this): batch 132 / 274
Testing (cite this): batch 133 / 274
Testing (cite this): batch 134 / 274
Testing (cite this): batch 135 / 274
Testing (cite this): batch 136 / 274
Testing (cite this): batch 137 / 274
Testing (cite this): batch 138 / 274
Testing (cite this): batch 139 / 274
Testing (cite this): batch 140 / 274
Testing (cite this): batch 141 / 274
Testing (cite this): batch 142 / 274
Testing (cite this): batch 143 / 274
Testing (cite this): batch 144 / 274
Testing (cite this): batch 145 / 274
Testing (cite this): batch 146 / 274
Testing (cite this): batch 147 / 274
Testing (cite this): batch 148 / 274
Testing (cite this): batch 149 / 274
Testing (cite this): batch 150 / 274
Testing (cite this): batch 151 / 274
Testing (cite this): batch 152 / 274
Testing (cite this): batch 153 / 274
Testing (cite this): batch 154 / 274
Testing (cite this): batch 155 / 274
Testing (cite this): batch 156 / 274
Testing (cite this): batch 157 / 274
Testing (cite this): batch 158 / 274
Testing (cite this): batch 159 / 274
Testing (cite this): batch 160 / 274
Testing (cite this): batch 161 / 274
Testing (cite this): batch 162 / 274
Testing (cite this): batch 163 / 274
Testing (cite this): batch 164 / 274
Testing (cite this): batch 165 / 274
Testing (cite this): batch 166 / 274
Testing (cite this): batch 167 / 274
Testing (cite this): batch 168 / 274
Testing (cite this): batch 169 / 274
Testing (cite this): batch 170 / 274
Testing (cite this): batch 171 / 274
Testing (cite this): batch 172 / 274
Testing (cite this): batch 173 / 274
Testing (cite this): batch 174 / 274
Testing (cite this): batch 175 / 274
Testing (cite this): batch 176 / 274
Testing (cite this): batch 177 / 274
Testing (cite this): batch 178 / 274
Testing (cite this): batch 179 / 274
Testing (cite this): batch 180 / 274
Testing (cite this): batch 181 / 274
Testing (cite this): batch 182 / 274
Testing (cite this): batch 183 / 274
Testing (cite this): batch 184 / 274
Testing (cite this): batch 185 / 274
Testing (cite this): batch 186 / 274
Testing (cite this): batch 187 / 274
Testing (cite this): batch 188 / 274
Testing (cite this): batch 189 / 274
Testing (cite this): batch 190 / 274
Testing (cite this): batch 191 / 274
Testing (cite this): batch 192 / 274
Testing (cite this): batch 193 / 274
Testing (cite this): batch 194 / 274
Testing (cite this): batch 195 / 274
Testing (cite this): batch 196 / 274
Testing (cite this): batch 197 / 274
Testing (cite this): batch 198 / 274
Testing (cite this): batch 199 / 274
Testing (cite this): batch 200 / 274
Testing (cite this): batch 201 / 274
Testing (cite this): batch 202 / 274
Testing (cite this): batch 203 / 274
Testing (cite this): batch 204 / 274
Testing (cite this): batch 205 / 274
Testing (cite this): batch 206 / 274
Testing (cite this): batch 207 / 274
Testing (cite this): batch 208 / 274
Testing (cite this): batch 209 / 274
Testing (cite this): batch 210 / 274
Testing (cite this): batch 211 / 274
Testing (cite this): batch 212 / 274
Testing (cite this): batch 213 / 274
Testing (cite this): batch 214 / 274
Testing (cite this): batch 215 / 274
Testing (cite this): batch 216 / 274
Testing (cite this): batch 217 / 274
Testing (cite this): batch 218 / 274
Testing (cite this): batch 219 / 274
Testing (cite this): batch 220 / 274
Testing (cite this): batch 221 / 274
Testing (cite this): batch 222 / 274
Testing (cite this): batch 223 / 274
Testing (cite this): batch 224 / 274
Testing (cite this): batch 225 / 274
Testing (cite this): batch 226 / 274
Testing (cite this): batch 227 / 274
Testing (cite this): batch 228 / 274
Testing (cite this): batch 229 / 274
Testing (cite this): batch 230 / 274
Testing (cite this): batch 231 / 274
Testing (cite this): batch 232 / 274
Testing (cite this): batch 233 / 274
Testing (cite this): batch 234 / 274
Testing (cite this): batch 235 / 274
Testing (cite this): batch 236 / 274
Testing (cite this): batch 237 / 274
Testing (cite this): batch 238 / 274
Testing (cite this): batch 239 / 274
Testing (cite this): batch 240 / 274
Testing (cite this): batch 241 / 274
Testing (cite this): batch 242 / 274
Testing (cite this): batch 243 / 274
Testing (cite this): batch 244 / 274
Testing (cite this): batch 245 / 274
Testing (cite this): batch 246 / 274
Testing (cite this): batch 247 / 274
Testing (cite this): batch 248 / 274
Testing (cite this): batch 249 / 274
Testing (cite this): batch 250 / 274
Testing (cite this): batch 251 / 274
Testing (cite this): batch 252 / 274
Testing (cite this): batch 253 / 274
Testing (cite this): batch 254 / 274
Testing (cite this): batch 255 / 274
Testing (cite this): batch 256 / 274
Testing (cite this): batch 257 / 274
Testing (cite this): batch 258 / 274
Testing (cite this): batch 259 / 274
Testing (cite this): batch 260 / 274
Testing (cite this): batch 261 / 274
Testing (cite this): batch 262 / 274
Testing (cite this): batch 263 / 274
Testing (cite this): batch 264 / 274
Testing (cite this): batch 265 / 274
Testing (cite this): batch 266 / 274
Testing (cite this): batch 267 / 274
Testing (cite this): batch 268 / 274
Testing (cite this): batch 269 / 274
Testing (cite this): batch 270 / 274
Testing (cite this): batch 271 / 274
Testing (cite this): batch 272 / 274
Testing (cite this): batch 273 / 274
ranks: tensor([1.0000e+01, 1.0000e+01, 1.0000e+01,  ..., 1.0000e+00, 1.0000e+00,
        2.7923e+04])
mr: 2025.748046875
mrr: 0.25207072496414185
h1: 0.22709117829799652
h3: 0.2513979375362396
h5: 0.2648065686225891
h10: 0.2911103367805481
==================================

Done Testing!
done with training and eval
Experiments took 4824 seconds on 
